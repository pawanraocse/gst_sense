<div class="layout-wrapper" [class.layout-sidebar-active]="sidebarActive()">

  <!-- Floating Sidebar (Glassmorphism) -->
  <aside class="layout-sidebar">
    <div class="sidebar-header">
      <div class="logo-container">
        <div class="logo-box">
          <i class="pi pi-bolt"></i>
        </div>
        <span class="app-name">GST Buddy</span>
      </div>
    </div>

    <div class="sidebar-content">
      <ul class="layout-menu">
        @for (item of items(); track item.label) {
        <li class="menu-item" [class.active-menuitem]="isActive(item.routerLink)">
          <a [routerLink]="item.routerLink" class="menu-link" (click)="onMenuClick()">
            <i [class]="item.icon"></i>
            <span>{{ item.label }}</span>
          </a>
        </li>
        }
      </ul>
    </div>

    <div class="sidebar-footer">
      <div class="user-card" *ngIf="authService.user() as user">
        <p-avatar icon="pi pi-user" shape="circle" styleClass="bg-primary-100 text-primary-700">
        </p-avatar>
        <div class="user-info">
          <span class="user-name text-truncate">{{ user.email.split('@')[0] }}</span>
          <span class="user-role">{{ user.tenantType === 'ORGANIZATION' ? 'Org' : 'Personal' }}</span>
        </div>
        <button class="logout-btn" (click)="logout()" pTooltip="Logout">
          <i class="pi pi-power-off"></i>
        </button>
      </div>
    </div>
  </aside>

  <!-- Main Content Container -->
  <div class="layout-main-container">
    <!-- Floating Header -->
    <header class="layout-header">
      <button class="sidebar-toggle md:hidden" (click)="toggleSidebar()">
        <i class="pi pi-bars"></i>
      </button>

      <div class="header-content">
        <!-- Breadcrumb or Title could go here -->
        <span class="text-secondary font-medium hidden md:block">
          Welcome back,
          <span class="text-900 font-semibold">{{ authService.user()?.email?.split('@')?.[0] }}</span>
        </span>

        <div class="header-actions">
          <button pButton icon="pi pi-bell" class="header-action-btn" [rounded]="true" [text]="true"></button>
          <button pButton icon="pi pi-cog" class="header-action-btn" [rounded]="true" [text]="true"></button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="layout-content">
      <div class="content-animation-wrapper">
        <router-outlet></router-outlet>
      </div>
    </main>
  </div>

  <div class="layout-mask md:hidden" *ngIf="sidebarActive()" (click)="sidebarActive.set(false)"></div>
  <app-share-dialog #shareDialog></app-share-dialog>
</div>